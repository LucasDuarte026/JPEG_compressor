#include <stdio.h>
#include <stdlib.h>
#define BLOCK_SIZE 8

//
const double M_dct[8][8] = {
    {0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536, 0.3536},
    {0.4904, 0.4157, 0.2778, 0.0975, -0.0975, -0.2778, -0.4157, -0.4904},
    {0.4619, 0.1913, -0.1913, -0.4619, -0.4619, -0.1913, 0.1913, 0.4619},
    {0.4157, -0.0975, -0.4904, -0.2778, 0.2778, 0.4904, 0.0975, -0.4157},
    {0.3536, -0.3536, -0.3536, 0.3536, 0.3536, -0.3536, -0.3536, 0.3536},
    {0.2778, -0.4904, 0.0975, 0.4157, -0.4157, -0.0975, 0.4904, -0.2778},
    {0.1913, -0.4619, 0.4619, -0.1913, -0.1913, 0.4619, -0.4619, 0.1913},
    {0.0975, -0.2778, 0.4157, -0.4904, 0.4904, -0.4157, 0.2778, -0.0975}};
const double M_dct_t[8][8] = {
    {0.3536, 0.4904, 0.4619, 0.4157, 0.3536, 0.2778, 0.1913, 0.0975},
    {0.3536, 0.4157, 0.1913, -0.0975, -0.3536, -0.4904, -0.4619, -0.2778},
    {0.3536, 0.2778, -0.1913, -0.4904, -0.3536, 0.0975, 0.4619, 0.4157},
    {0.3536, 0.0975, -0.4619, -0.2778, 0.3536, 0.4157, -0.1913, -0.4904},
    {0.3536, -0.0975, -0.4619, 0.2778, 0.3536, -0.4157, -0.1913, 0.4904},
    {0.3536, -0.2778, -0.1913, 0.4904, -0.3536, -0.0975, 0.4619, -0.4157},
    {0.3536, -0.4157, 0.1913, 0.0975, -0.3536, 0.4904, -0.4619, 0.2778},
    {0.3536, -0.4904, 0.4619, -0.4157, 0.3536, -0.2778, 0.1913, -0.0975}};

int A[BLOCK_SIZE][BLOCK_SIZE] = {
    {52, 55, 61, 66, 70, 61, 64, 73},
    {63, 59, 66, 90, 109, 85, 69, 72},
    {62, 59, 68, 113, 144, 104, 66, 73},
    {63, 58, 71, 122, 154, 106, 70, 69},
    {67, 61, 68, 104, 126, 88, 68, 70},
    {79, 65, 60, 70, 77, 68, 58, 75},
    {85, 71, 64, 59, 55, 61, 65, 83},
    {87, 79, 69, 68, 65, 76, 78, 94}};
int A_T[BLOCK_SIZE][BLOCK_SIZE] = {
    {52, 63, 62, 63, 67, 79, 85, 87},
    {55, 59, 59, 58, 61, 65, 71, 79},
    {61, 66, 68, 71, 68, 60, 64, 69},
    {66, 90, 113, 122, 104, 70, 59, 68},
    {70, 109, 144, 154, 126, 77, 55, 65},
    {61, 85, 104, 106, 88, 68, 61, 76},
    {64, 69, 66, 70, 68, 58, 65, 78},
    {73, 72, 73, 69, 70, 75, 83, 94}
};

double C[BLOCK_SIZE][BLOCK_SIZE] = {
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0}};
double D[BLOCK_SIZE][BLOCK_SIZE] = {
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0}};
double F[BLOCK_SIZE][BLOCK_SIZE] = {
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0},
    {0, 0, 0, 0, 0, 0, 0, 0}};
int main()
{

    for (int i = 0; i < BLOCK_SIZE; i++)
    {
        for (int j = 0; j < BLOCK_SIZE; j++)
        {
            C[i][j] = 0; // Inicializa o elemento
            for (int k = 0; k < BLOCK_SIZE; k++)
            {
                // C[i][j] += (int) A[i][k] * M_dct[k][j];
                C[i][j] += M_dct[i][k] * A_T[j][k];
            }
        }
    }
    printf("\n TRANSFORMADA DCT\n");

    for (int i = 0; i < BLOCK_SIZE; i++)
    {
        for (int j = 0; j < BLOCK_SIZE; j++)
        {
            D[i][j] = 0; // Inicializa o elemento
            for (int k = 0; k < BLOCK_SIZE; k++)
            {
                D[i][j] += C[i][k] * M_dct[j][k];
            }
            printf("%6.3f ", D[i][j]);
        }
        printf("\n");
    }



    printf("\n agora a volta\n");

    for (int i = 0; i < BLOCK_SIZE; i++)
    {
        for (int j = 0; j < BLOCK_SIZE; j++)
        {
            C[i][j] = 0; // Inicializa o elemento
            for (int k = 0; k < BLOCK_SIZE; k++)
            {
                // C[i][j] += (int) A[i][k] * M_dct[k][j];
                C[i][j] += M_dct[k][i] * D[k][j];
            }
        }
    }

    for (int i = 0; i < BLOCK_SIZE; i++)
    {
        for (int j = 0; j < BLOCK_SIZE; j++)
        {
            F[i][j] = 0; // Inicializa o elemento
            for (int k = 0; k < BLOCK_SIZE; k++)
            {
                F[i][j] += C[i][k] * M_dct_t[j][k];
            }
            printf("%6.3f ", F[i][j]);
        }
        printf("\n");
    }

    printf("\n agora a volta arredondado\n");
    for (int i = 0; i < BLOCK_SIZE; i++)
    {
        for (int j = 0; j < BLOCK_SIZE; j++)
        {
            F[i][j] = 0; // Inicializa o elemento
            for (int k = 0; k < BLOCK_SIZE; k++)
            {
                F[i][j] += C[i][k] * M_dct_t[j][k];
            }
            printf("%d ", (int)F[i][j]);
        }
        printf("\n");
    }
    return 0;
}